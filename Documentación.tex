\documentclass{article}
\usepackage{graphicx}
\usepackage[margin=3cm]{geometry}
\usepackage{subcaption}
\usepackage[utf8]{inputenc}
\usepackage{url}
\usepackage{tcolorbox}
\usepackage{listings}




\title{Documentación Taco Paco}
\author{Santi Martínez}
\date{\today}

\begin{document}
    \maketitle
    \newpage
    \tableofcontents


    % ================================= INTRODUCCIÓN =========================================
    \newpage
    \section{Introducción}
        Taco Paco es una aplicación de comida rápida en la que el cliente puede reservar su mesa, y a partir de ahí seleccionar sus productos favoritos.

        \vspace{0.5cm}
        \begin{tcolorbox}[colback=green!2!white,colframe=green!50!black,fonttitle=\bfseries,title=Historia de Taco Paco]
            La historia de Taco Paco comienza en 1998, cuando dos amigos decidieron abrir un pequeño restaurante de comida rápida en el centro de la ciudad. Con el tiempo, el restaurante fue ganando popularidad gracias a su deliciosa comida y su ambiente acogedor. Hoy en día, Taco Paco es un referente en la comida rápida de la ciudad, y su aplicación móvil es una herramienta esencial para sus clientes.
        \end{tcolorbox}


        \begin{figure}[h!]
            \centering
            \includegraphics[width=0.4\textwidth]{images/logo-tacopaco.png}
            \caption{Loco Taco Paco}
        \end{figure}

        El proyecto consta de dos aplicaciones principales: una app móvil para el cliente y una app de escritorio para el personal del establecimiento.
        \begin{itemize}
            \item La app de escritorio forma parte únicamente del establecimiento, ya que su funcionalidad radica en cobrar pedidos y liberar las mesas. Gracias a ello podrá ver también las mesas libres y las ocupadas.
            \item La app móvil está diseñada para el cliente, el cual podrá seleccionar su mesa y realizar sus pedidos a través de la carta.
        \end{itemize}

        Ambas se conectan entre sí a través de una \textbf{API Rest} elaborada con express y  que se conecta a la base de datos con mongoose, para guardar y editar los cambios en Mongo Atlas.
        \vspace{0.5cm}

        A continuación se explicará todo lo relacionado con la arquitectura de la app, las funcionalidades de ambas aplicaciones y la API Rest, así como los problemas encontrados durante el desarrollo del proyecto.



    % ================================= AQRUITECTURA DE LA APP =========================================
    \newpage
    \section{Arquitectura de la app}
        \subsection{Diagrama de flujo}
            \begin{figure}[h!]
                \centering
                \includegraphics[width=0.9\textwidth]{images/Diagrama-flujo.png}
                \caption{Diagrama de flujo}
            \end{figure}
        

        \newpage
        \subsection{Diagrama de casos de uso}
            El \textbf{Diagrama de casos de uso} muestra las posibles utilizaciones de la aplicación por todos los actores*.

            \vspace{0.5cm}
            *\underline{Actor}: Es el cliente y el servidor, los entes que pueden darle usos a la app.

            \vspace{0.5cm}
            En este caso el diagrama contiene dos \textbf{includes} por parte del cliente, que vienen a partir de la selección de productos dentro de la carta.
            \begin{itemize}
                \item Realizar Pedido
                \item Cancelar Pedido
            \end{itemize}

            Mientras que \textbf{extends} contiene uno solo por parte del Servidor:
            \begin{itemize}
                \item Librar mesas
            \end{itemize}


            \vspace{0.5cm}
            \begin{tcolorbox}[colback=green!3!white,colframe=green!50!black,fonttitle=\bfseries,title=Includes y extends]
                \textbf{Include}.
                Permite reutilizar funcionalidad común entre casos de uso, insertando obligatoriamente un caso dentro de otro para evitar duplicación.

                \textbf{Extend}.
                Agrega comportamiento opcional o condicional a un caso de uso principal, ejecutándose solo bajo ciertas condiciones o escenarios específicos.
            \end{tcolorbox}

            \begin{figure}[h!]
                \centering
                \includegraphics[width=0.65\textwidth]{images/Diagrama-casos-de-uso.png}
                \caption{Diagrama de casos de uso}
            \end{figure}


    % ================================= APP MÓVIL =========================================
    \newpage
    \section{APP Móvil}

        \subsection*{Imágenes de la app}

            % == Pantalla de inicio ==
            \begin{minipage}{.5\textwidth}
                \vspace{0.5cm}
                \textbf{\begin{center}Pantalla principal\end{center}}
                \vspace{0.5cm}

                Primera pantalla que se encuentra el usuario al iniciarl la app, la única funcionalidad que tiene es la que le da el botón \textbf{Entrar}, el cual como su nombre indica, sirve para entrar en el siguiente menú de la app.
                \vspace{0.5cm}

                En la pantalla se encuentra el nombre de la empresa junto a su año en la que se fundó. También el botón de entrar que es el encargado de cambiar entre activities.
            \end{minipage}
            \hspace{1cm}
            \begin{minipage}{.4\textwidth}
                \includegraphics[scale=0.3]{images/pantalla_principal.png}
            \end{minipage}

            % == Pantalla de mesas (TODAS LIBRES) ==
            \begin{minipage}{.4\textwidth}
                \includegraphics[scale=0.3]{images/pantalla_mesas.png}
            \end{minipage}
            \begin{minipage}{.5\textwidth}
                \vspace{0.5cm}
                \textbf{\begin{center}CASO 1: Todas las mesas libres\end{center}}
                \vspace{0.5cm}

                Esta es la pantalla en la que se muestran las mesas disponibles del establecimiento. Se trata de un menú con 5 mesas:
                \begin{itemize}
                    \item 3 interiores
                    \item 2 terraza
                \end{itemize}
                Esta diferenciación se encuentra en la parte baja de la pantalla, la cual se destaca con dos colores diferentes.

                En pantalla se encuentran los botones que llevan a los activities de sus respectivas mesas y un botón para volver al activity anterior.
            \end{minipage}

            % == Pantalla de mesas (CON OCUPADAS) ==
            \begin{minipage}{.5\textwidth}
                \vspace{0.5cm}
                \textbf{\begin{center}CASO 2: Mesas ocupadas\end{center}}
                \vspace{0.5cm}

                Mismo funcionamiento que en el caso anterior, pero sin embargo en esta pantalla se pueden apreciar que tanto la \textbf{Mesa 3} como la \textbf{Mesa 4}, se encuentran ocupadas.
                
                La app no va a permitir su ocupación ni utilización de las mismas, es decir, quedan bloqueadas hasta que desde la APP-Escritorio se libreren cobrando el pedido a los clientes.
            \end{minipage}
            \hspace{1cm}
            \begin{minipage}{.4\textwidth}
                \includegraphics[scale=0.3]{images/pantalla_mesas_ocupadas.png}
            \end{minipage}

            % == CARTA ==
            \begin{minipage}{.4\textwidth}
                \includegraphics[scale=0.3]{images/pantalla_carta.png}
            \end{minipage}
            \begin{minipage}{.5\textwidth}
                \vspace{0.5cm}
                \textbf{\begin{center}Carta\end{center}}
                \vspace{0.5cm}

                Esta es la pantalla en la que se muestran las mesas disponibles del establecimiento. Se trata de un menú con 5 mesas:
                \begin{itemize}
                    \item 3 interiores
                    \item 2 terraza
                \end{itemize}
                Esta diferenciación se encuentra en la parte baja de la pantalla, la cual se destaca con dos colores diferentes.

                En pantalla se encuentran los botones que llevan a los activities de sus respectivas mesas y un botón para volver al activity anterior.
            \end{minipage}

        
    % ================================= APP ESCRITORIO =========================================
    \newpage
    \section{APP Escritorio}
        La app escritorio está diseñada para ser utilizada por el personal del establecimiento Taco Paco. Su función principal es gestionar las mesas del restaurante, permitiendo al personal ver qué mesas están ocupadas y cuáles están libres, así como tambíen tienen la facultad de limpiar las mesas y liberarlas una vez que los clientes han pagado su pedido.



        % == Pantalla inicio de APP Escritorio ==
        \subsection{Inicio app}

        Esta es la pantalla inicial de la app escritorio, en la que al pulsar \textbf{Entrar}, se abre el siguiente activity.

        Cabe decir que es una app únicamente para el establecimiento de Taco Paco, ya que sus posibles usos son:
        \begin{itemize}
            \item Establecer un control de qué mesas están o no disponibles
            \item En caso de que no estén disponibles, se les puede cobrar su pedido desde esta app, lo que libera a continuación la mesa
        \end{itemize}

        \begin{figure}[h!]
            \centering
            \includegraphics[width=0.9\textwidth]{images/escritorio-principal.png}
            \caption{Pantalla de inicio de la app escritorio}
        \end{figure}


        % == Pantalla mesas libres==
        \newpage
        \subsection{Control de mesas. CASO 1: Todas las mesas libres}

        Esta pantalla es la principal de la app. Como se puede observar contiene como contenido prioritario las 5 mesas des establecimiento. En este caso no hay ninguna mesa con un pedido pendiente.

        \vspace{0.5cm}

        Además, en la parte superior derecha se encuentra el botón de \textbf{Actualizar}, que sirve para refrescar el estado de las mesas en caso de que haya habido algún cambio desde la app móvil.
        
        \begin{figure}[h!]
            \centering
            \includegraphics[width=0.9\textwidth]{images/escritorio-mesas.png}
            \caption{Todas las mesas disponibles}
        \end{figure}

        % == Pantalla mesas ocupadas ==
        \newpage
        \subsection{Control de mesas. CASO 2: Mesas ocupadas}

        Las mesas ocupadas se pueden apreciar por su fondo en rojo y tienen dos estados:
        \begin{itemize}
            \item \textbf{Mesa con pedido pendiente}: La mesa aparece de color rojo (ocupada) pero como el cliente todavía tiene la opción de seguir pidiendo y no ha pagado, no se puede liberar la mesa.
            \item \textbf{Mesa ocupada con pedido ya pagado}: En este caso, el cliente ya ha pagado su pedido desde la app móvil, pero el camarero no ha liberado la mesa. Al clicar en el botón \textbf{Limpiar mesa}, se libera la mesa y vuelve a estar disponible para nuevos clientes.
        \end{itemize}

        Una vez limpia la mesa, esta vuelve automáticamente a estar disponible en la app móvil, sin necesidad de actualizar nada.
    
        \begin{figure}[h!]
            \centering
            \includegraphics[width=0.9\textwidth]{images/escritorio-mesas-ocupada.png}
            \caption{Mesas ocupadas en rojo}
        \end{figure}


    % ================================= API REST =========================================
    \newpage
    \section{API Rest}

        \subsection{Flujo de la API con las APPs}
            \begin{figure}[h!]
                \centering
                \includegraphics[width=0.9\textwidth]{images/Diagrama-GRAFO.png}
                \caption{Diagrama de grafo}
            \end{figure}
        
        \newpage
        \subsection{Componentes}
            
            \begin{figure}[h!]
                \centering
                \includegraphics[width=0.9\textwidth]{images/estructura-api .png}
                \caption{Estructura de la API}
            \end{figure}

            \newpage
            \subsubsection{models/}
            Explicación de lo que son los models
            
            % MODELO MESA
            \begin{tcolorbox}[colback=green!2!white,colframe=green!65!black,fonttitle=\bfseries,title=Endpoints]
                \begin{lstlisting}
    const mongoose = require('mongoose')
    const mesaSchema = new mongoose.Schema(
        {
            nombre: { type: String, required: true, unique: true },
            ocupada: { type: Boolean, default: false }
        },
        { versionKey: false }
    );
    const Mesa = mongoose.model("Mesas", mesaSchema);
                \end{lstlisting}
            \end{tcolorbox}
 
            % MODELO PRODUCTO
            \begin{tcolorbox}[colback=green!2!white,colframe=green!65!black,fonttitle=\bfseries,title=Endpoints]
                \begin{lstlisting}
    const mongoose = require('mongoose')
    const pedidoSchema = new mongoose.Schema(
        {
            precioTotal: { type: Number, required: true }
        },
        { versionKey: false }
    );
    const Pedido = mongoose.model("Pedidos", pedidoSchema);
                \end{lstlisting}
            \end{tcolorbox}

            \subsubsection{node\_modules/}
                Conjunto de bibliotecas de node. Cada una de ellas cumplen una función en la API:
                \begin{itemize}
                    \item \textbf{pnpm}: Paquete instalador de node elegido
                    \item \textbf{dotenv}: Para la utilización de las variables de entorno guardadas en el .env
                    \item \textbf{express}: Módulo con el que se construye la API
                    \item \textbf{mongoose}: Módulo de Mongo que sirve para conectarse de forma sencilla a la base de datos de Mongo Atlas. A traves de los modelos creados anteriormente, se pueden guardar, actualizar y eliminar datos en la base de datos a través de los endpoints.
                \end{itemize}

            \subsubsection{server (Endpoints)}





    % ================================= PROBLEMAS ENCONTRADOS =======================================
    \newpage
    \section{Problemas encontrados}
        \subsection{Conexión entre las APPs y la API}
            Uno de los principales problemas encontrados fue la conexión entre las aplicaciones y la API Rest. Al principio, iba más o menos todo bien, el problema llegó a raíz de un mal planeamiento inicial de la arquitectura de la app.

            \vspace{0.5cm}
            Al tener que modificar los modelos de \textbf{mesa} y \textbf{pedido} varias veces, se generaron conflictos entre las aplicaciones y la API, ya que por ejemplo, al principio la clase \textbf{mesa} no tenía el atributo \textbf{a\_pagar}, lo que provocaba que el botón de \textbf{Limpiar mesa} no funcionara correctamente.

        \subsection{Calls}
            Otro problema fue la gestión de las peticiones asíncronas (los Calls). 
            Tuve que pararme a entender bien el cómo trabajaban por detrás y darme cuenta de que como dije antes, son peticiones asíncronas; partiendo de eso y tras pararme con ello (no negaré cierta ayuda virtual...), conseguí que enlazara todo correctamente.

        \subsection{Organización inicial}
            Pero creo que el principal problema fue mi falta de organicación a la hora de crear la estructura de las apps; fue en un principio organizado, pero fui haciendo cambios a medida avanzaba el proyecto, y eso ocasionó el error anteriormente mencionado.

        \subsection{Desarrollo de frontend}
            Pese a que a mi parecer he mejorado un poco a nivel interfaz gráfica, sigue siengo algo que se me atasca un poco. Creo que también es cuestión de investigar un poco más.
            \vspace{0.5cm}

            En este proyecto empecé a inspirarme en imágenes de apps en pinterest, y a partir de ahí fui cogiendo pequeñas ideas. Este paso fue algo bueno para mi, ya que me dió una perspectiva de casos reales y el cómo tendría que ser este tipo de aplicación.

    % ================================= CONCLUSIÓN =========================================
    \newpage
    \section{Conclusión}
            Este proyecto me fue un poco montaña rusa a nivel de apetencia de trabajo. Hubo días en los que me gustaba avanzar y romperme un poco la cabeza y otros en los que no me apetecía ni verlo, pero supongo que es algo común en proyectos "largos".

            \vspace{0.5cm}
            A estas alturas, respecto al anterior proyecto, me siento un poco más cómodo con las tecnologías utilizadas, ya sea por la acumulación de práctica en las mismas o por que está entrando \textbf{muy poco a poco} en mi zona de confort.
            \begin{itemize}
                \item \textbf{Android Studio}: Es una herramienta que va de la mano con lo que dije al principio de la conclusión, hay días que me siento muy cómodo y otros que pienso solamente en el logo de Android Studio y me apetece borrarlo del pc.
                \item \textbf{Javafx}: Lo mismo que la anterior, pero al ser, bajo mi opinión, mas sencilla a nivel cantidad de archivos, puede que no me de en ocasiones tanta pereza en x ocasiones.
            \end{itemize}

            Aunque parezca de momento que ambas las tiraría a la basura, creo que a medida que ha avanzado el curso me han ido gustando un poco más; sería la analogía a comer una hamburguesa con catarro, bien pero no me sabe.

            \vspace{0.5cm}
            En cuanto a la API, es la primera vez que hago modular el tema de los modelos de mongo, y algún problema que otro me ha dado, el cual tuve que solicitar ayuda a la IA para averiguar ciertor errores que ni viendo los logs pude resolver.

            \vspace{0.5cm}
            \underline{Y ahora vamos por fin con el contenido del proyecto.}

            \vspace{0.5cm}
            Me ha parecido un tema entretenido y con aplicaciones al mundo real, lo que fue parte del incentivo motivacional para llevarlo a cabo. Es la primera vez que hago dos apps para un mismo proyecto y la verdad es que ya se puede ver (bajo la perspectiva de mi nivel) ciertos resquicios de mundo real a nivel proyecto, obviamente con lmiitaciones.

            \vspace{0.5cm}
            Como conclusión final decir que lo que me ha ayudado bastante a ver con perspectiva el proyecto, fue el hablar con mis compañeros de clase de problemas que nos surgían, cosa que tendría que empezar a hacer más a menudo, ya que muchas veces me encierro en mi mundo, pongo cascos y tiro para adelante.



    % ================================= BIBLIOGRAFÍA =========================================
    \newpage
    \section{Bibliografía}
        \begin{itemize}
            \item \textbf{Formatos de imagen de Latex}: \url{https://manualdelatex.com/tutoriales/figuras}
            \item \textbf{Imagen al lado de texto en Latex}: \url{https://foro.rinconmatematico.com/index.php?topic=114810.0}
            \item \textbf{Texto al rededor de figuras en Latex}: \url{https://es.wikibooks.org/wiki/Manual_de_LaTeX/Inclusi%C3%B3n_de_gr%C3%A1ficos/Texto_alrededor_de_figuras}
            \item \textbf{Insertar código en el pdf}: \url{https://trspos.com/insertar-bloque-de-codigo-latex/}
            \item \textbf{Dependencias retrofit} :\url{https://square.github.io/retrofit/download/}
            \item \textbf{Cuadros en latex}: \url{https://www.youtube.com/watch?v=ZN2QC1pcjMI}
        \end{itemize}
        




\end{document}